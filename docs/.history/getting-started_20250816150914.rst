GUANACO Interface
===============

Overview the data
-----------
After open the interface, the default shown section is description section, containing the size of dataset, and what metadata it has. The main view is a side-by-side Embedding plot. Both side can be coloured by metadata showed in description section and genes by the selection in the dropdown. The image below highlight how to quickly view the dataset to understand most of the information.

.. image:: assets/interface1.png
   :width: 1000

Use 'Global DATA FILTER' to select and deselect cells shown in the embedding. All embeddings in .obsm will be in selection in Dimension Reduction. Note that for dimensional reduction methods that yields more than two axis. User can select at most two of them to display in selection 'X-axis','Y-axis'.

Scroll the mouse to zoom in and zoom out. There are three icon in the upper right coner. camaera one is for downloading current view in .svg format. And in Pan tool mode(middle one), hold the space bar and drag the mouse to move the view. and double click to go back to default view. With lasso selection tool, user can select cells in the left embedding and pass the cells to other plots.(see more in select cell section)

----

Marker Genes Visualization
^^^^^^^^^^^^^^^^^^^^^^^^^^


Heatmap

GUANACO provide single cell level heatmap, supporting max to 50k cells. cells(columns) and gene(row) is controled by the left area. If dataset has more than 50k cells, it will binning them. Provide three two transformation methods, log and z-score. When using z-score, for better visualization , we used 99 percentile.

GUANACO support two annotations and one of them can be continous metadata like pseudotime. In default, with two annoations, the cells are first clustered by first annotatioin and then within the first annotation, cells are clustered by the second annoation. But if the second annotation isn continuse, it will prioritize the order by continuse variable.

.. image:: assets/heatmap.png
   :width: 1000

For graphich setting, the discre colormap for the first annotation is same as embedding section,and the secondary annnotation colormap can be determined by dropdown. We also offer 96 continous colormap for heatmap. It is recommend to use Sequential Color scales for raw and log data, and use Built-In Diverging Color scales to for z-score data to hilight the difference:

.. image:: assets/z-score_heatmap.png
   :width: 1000

More color information can be found in color section.


Violin plot

GUANACO provide two types of violins: stacked and split/grouped. The first one is for visualizing mutilple markers and the second one serves more to group comparison.

.. image:: assets/violin1.png
   :width: 1000

Again the color is consistent with the shown in embeddings. Here we have the option to show the box plot inside of the violin and scatter dot beside it. Note showing all scatter points for large dataset and with multiple genes could be slow.


Split/grouped violin is very helpful for comparing different groups. It allows for a clear visualization of the distribution of each group. We provide 4 mode ro analysis the data.

Mode1: One metadata only. It only consider the first metadata for grouping. If there's only two groups, we offer manm-Witney U test and T test. For more than 2 groups, we provide KW test and ANNOVA.

Mode2: Facet by first metadata and compare the second metadata. It will show the first metadata as facet and the second metadata as group. If there's only two groups in the seocnd metdata, we offer manm-Witney U test and T test and show the split violin view. For more than 2 groups, we provide KW test and ANNOVA, and show grouped violin view.

Mode3: Linear Mode. We assume obs2 as a confounder: expression ~ obs1 + obs2. For non nested two metadata, for example, treatment and gender.

Mode4: Mixed Model. Mixed model treating obs2 as random effect: expression ~ meta1 + (1|obs2). Useful for heriachy structure data, like metadata1 = condition, metadata2 = patient. patient is nested with conditioin.

.. image:: assets/violin2.png
   :width: 1000

Dot plot

Stacked bar plot

Pseudotime plot

Select cells
^^^^^^^^^^^^^^^^^^^^^^^^^^
Lasso selection

Note, legend is just for viewing, not for selection

Export selected subgroup
^^^^^^^^^^^^^^^^^^^^^^^^

.h5ad

CellID